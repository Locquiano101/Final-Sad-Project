<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      * {
        margin: 0px;
        padding: 0px;
      }
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }
      div {
        border: 1px solid black;
      }
      .input-field input,
      select {
        width: 100%;
        border: 1px solid black;
        padding: 1rem;
      }
      .input-field {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        gap: 2rem;
      }
      .form {
        display: flex;
        width: 25%;
        flex-direction: column;
        align-items: center;
        padding: 2rem;
        gap: 2rem;
        justify-content: center;
      }
    </style>
  </head>
  <body>
    <div class="form">
      <div class="input-field">
        <select id="country" name="country">
          <option value="" disabled selected hidden>Country</option>
        </select>
      </div>

      <div class="input-field">
        <select id="province" name="province">
          <option value="" disabled selected hidden>Province</option>
        </select>
      </div>

      <div class="input-field">
        <select id="municipality" name="municipality">
          <option value="" disabled selected hidden>City/Municipality</option>
        </select>
      </div>

      <div class="input-field">
        <select id="barangay" name="barangay">
          <option value="" disabled selected hidden>Barangay</option>
        </select>
      </div>

      <div class="input-field">
        <select id="purok" name="purok">
          <option value="" disabled selected hidden>Street/Purok</option>
        </select>
      </div>
    </div>

    <script>
      var config = {
        cUrl: `https://api.countrystatecity.in/v1/countries`,
        cKey: `T2RtemxNcnR1b3oyam13WjlVS0lIbGl2cVhqMm5MMU1nNm0zZ0M3OQ==`,
      };

      // Get references to select elements
      var countrySelect = document.getElementById("country");
      var provinceSelect = document.getElementById("province");
      var municipalitySelect = document.getElementById("municipality");
      var barangaySelect = document.getElementById("barangay");

      // Load countries
      function loadCountries() {
        fetch(config.cUrl, { headers: { "X-CSCAPI-KEY": config.cKey } })
          .then((response) => response.json())
          .then((data) => {
            data.forEach((country) => {
              const option = document.createElement("option");
              option.value = country.iso2;
              option.textContent = country.name;
              countrySelect.appendChild(option);
            });
          })
          .catch((error) => console.error("Error loading countries:", error));
      }

      // Load provinces based on the selected country
      function loadProvinces() {
        const selectedCountryCode = countrySelect.value;
        provinceSelect.innerHTML =
          '<option value="" disabled selected hidden>Province</option>';
        municipalitySelect.innerHTML =
          '<option value="" disabled selected hidden>City/Municipality</option>';
        barangaySelect.innerHTML =
          '<option value="" disabled selected hidden>Barangay</option>';

        fetch(`${config.cUrl}/${selectedCountryCode}/states`, {
          headers: { "X-CSCAPI-KEY": config.cKey },
        })
          .then((response) => response.json())
          .then((data) => {
            data.forEach((province) => {
              const option = document.createElement("option");
              option.value = province.iso2;
              option.textContent = province.name;
              provinceSelect.appendChild(option);
            });
          })
          .catch((error) => console.error("Error loading provinces:", error));
      }

      // Load municipalities based on the selected province
      function loadMunicipalities() {
        municipalitySelect.innerHTML =
          '<option value="" disabled selected hidden>City/Municipality</option>';
        barangaySelect.innerHTML =
          '<option value="" disabled selected hidden>Barangay</option>';

        const selectedCountryCode = countrySelect.value;
        const selectedProvinceCode = provinceSelect.value;

        // Fetch municipality data if the API endpoint is available
        fetch(
          `${config.cUrl}/${selectedCountryCode}/states/${selectedProvinceCode}/cities`,
          {
            headers: {
              "X-CSCAPI-KEY": config.cKey,
            },
          }
        )
          .then((response) => response.json())
          .then((data) => {
            console.log(data);
            // data.forEach((municipality) => {
            //   const option = document.createElement("option");
            //   option.value = municipality.name;
            //   option.textContent = municipality.name;
            //   municipalitySelect.appendChild(option);
            // });
          })
          .catch((error) =>
            console.error("Error fetching municipalities:", error)
          );
      }

      // Load barangays based on the selected municipality
      function loadBarangays() {
        // Placeholder function as barangays are not provided in all APIs. Customize based on API structure if available.
        barangaySelect.innerHTML =
          '<option value="" disabled selected hidden>Barangay</option>';

        // Fetch barangays if API endpoint is available here
        // Populate barangaySelect similarly
      }

      // Add event listeners for cascading selections
      countrySelect.addEventListener("change", loadProvinces);
      provinceSelect.addEventListener("change", loadMunicipalities);
      municipalitySelect.addEventListener("change", loadBarangays);

      // Load countries when the page is loaded
      document.addEventListener("DOMContentLoaded", loadCountries);
    </script>
  </body>
</html>
